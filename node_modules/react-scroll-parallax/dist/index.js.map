{"version":3,"file":"index.js","names":["ParallaxController","React","newElement: Element | undefined","options: CreateElementOptions","absoluteStyle: CSSProperties","containerStyle: CSSProperties","React","ParallaxController","ScrollAxis"],"sources":["../src/utils/removeUndefinedObjectKeys.ts","../src/helpers/getIsolatedParallaxProps.ts","../src/components/Parallax/hooks.ts","../src/context/ParallaxContext.ts","../src/hooks/useParallaxController.ts","../src/hooks/useParallax.ts","../src/components/Parallax/Parallax.tsx","../src/components/ParallaxBanner/helpers/getExpandedStyle.ts","../src/components/ParallaxBanner/helpers/getImageStyle.ts","../src/components/ParallaxBanner/components/ParallaxBannerLayer.tsx","../src/components/ParallaxBanner/ParallaxBanner.tsx","../src/components/ParallaxProvider/helpers.ts","../src/components/ParallaxProvider/ParallaxProvider.tsx"],"sourcesContent":["export function removeUndefinedObjectKeys(obj: { [key: string]: any }) {\n  Object.keys(obj).forEach((key) => obj[key] === undefined && delete obj[key]);\n  return obj;\n}\n","import { ParallaxElementConfig } from 'parallax-controller';\nimport { removeUndefinedObjectKeys } from '../utils/removeUndefinedObjectKeys';\n\nexport function getIsolatedParallaxProps(\n  props: any\n): {\n  parallaxProps: ParallaxElementConfig;\n  rest: Record<string, any>;\n} {\n  const {\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n    ...rest\n  } = props;\n\n  const parallaxProps = removeUndefinedObjectKeys({\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n  });\n\n  return {\n    parallaxProps,\n    rest,\n  };\n}\n","import { ParallaxController } from 'parallax-controller';\nimport { useEffect } from 'react';\n\nexport function useVerifyController(controller: ParallaxController | unknown) {\n  useEffect(() => {\n    const isServer = typeof window === 'undefined';\n    // Make sure the provided controller is an instance of the Parallax Controller\n    const isInstance = controller instanceof ParallaxController;\n    // Throw if neither context or global is available\n    if (!isServer && !controller && !isInstance) {\n      throw new Error(\n        \"Must wrap your application's <Parallax /> components in a <ParallaxProvider />.\"\n      );\n    }\n  }, [controller]);\n}\n","import React from 'react';\nimport { ParallaxController } from 'parallax-controller';\n\nexport const ParallaxContext =\n  React.createContext<ParallaxController | null>(null);\n","import { useContext } from 'react';\nimport { ParallaxController } from 'parallax-controller';\nimport { ParallaxContext } from '../context/ParallaxContext';\n\nexport function useParallaxController(): ParallaxController | null {\n  const parallaxController = useContext(ParallaxContext);\n  const isServer = typeof window === 'undefined';\n  if (isServer) {\n    return null;\n  }\n\n  if (!parallaxController) {\n    throw new Error(\n      'Could not find `react-scroll-parallax` context value. Please ensure the component is wrapped in a <ParallaxProvider>'\n    );\n  }\n\n  return parallaxController;\n}\n","import { CreateElementOptions, Element } from 'parallax-controller';\nimport { useEffect, useRef, useState } from 'react';\nimport { useVerifyController } from '../components/Parallax/hooks';\nimport { ParallaxProps } from '../components/Parallax/types';\nimport { getIsolatedParallaxProps } from '../helpers/getIsolatedParallaxProps';\nimport { useParallaxController } from './useParallaxController';\n\nexport function useParallax<T extends HTMLElement>(props: ParallaxProps) {\n  const controller = useParallaxController();\n  const ref = useRef<T>(null);\n  const { parallaxProps } = getIsolatedParallaxProps(props);\n\n  useVerifyController(controller);\n\n  const [element, setElement] = useState<Element>();\n\n  // create element\n  useEffect(() => {\n    let newElement: Element | undefined;\n    if (ref.current instanceof HTMLElement) {\n      const options: CreateElementOptions = {\n        el: ref.current,\n        props: parallaxProps,\n      };\n      newElement = controller?.createElement(options);\n      setElement(newElement);\n    } else {\n      throw new Error(\n        'You must assign the ref returned by the useParallax() hook to an HTML Element.'\n      );\n    }\n\n    return () => {\n      if (newElement) {\n        controller?.removeElementById(newElement.id);\n      }\n    };\n  }, []);\n\n  // update element\n  useEffect(() => {\n    if (element) {\n      if (props.disabled) {\n        controller?.resetElementStyles(element);\n        controller?.updateElementPropsById(element.id, parallaxProps);\n      } else {\n        controller?.updateElementPropsById(element.id, parallaxProps);\n      }\n    }\n  }, [\n    props.disabled,\n    props.easing,\n    props.endScroll,\n    props.onChange,\n    props.onEnter,\n    props.onExit,\n    props.onProgressChange,\n    props.opacity,\n    props.rootMargin,\n    props.rotate,\n    props.rotateX,\n    props.rotateY,\n    props.rotateZ,\n    props.scale,\n    props.scaleX,\n    props.scaleY,\n    props.scaleZ,\n    props.shouldAlwaysCompleteAnimation,\n    props.shouldDisableScalingTranslations,\n    props.speed,\n    props.startScroll,\n    props.targetElement,\n    props.translateX,\n    props.translateY,\n  ]);\n\n  return { ref, controller, element };\n}\n","import React, { PropsWithChildren } from 'react';\nimport { getIsolatedParallaxProps } from '../../helpers/getIsolatedParallaxProps';\nimport { useParallax } from '../../hooks/useParallax';\nimport { ParallaxProps } from './types';\n\nexport function Parallax(props: PropsWithChildren<ParallaxProps>) {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const { ref } = useParallax<HTMLDivElement>(parallaxProps);\n  return (\n    <div ref={ref} {...rest}>\n      {props.children}\n    </div>\n  );\n}\n","import { parseValueAndUnit } from 'parallax-controller';\nimport { BannerLayer } from '../types';\n\nconst FALLBACK_RECT = {\n  height: 0,\n};\n\ntype ExpandedStyle = {\n  top?: string;\n  bottom?: string;\n};\n\nexport function getExpandedStyle(layer: BannerLayer): ExpandedStyle {\n  if (Array.isArray(layer.translateY)) {\n    const translateYStart = parseValueAndUnit(layer.translateY[0]);\n    const translateYEnd = parseValueAndUnit(layer.translateY[1]);\n\n    if (translateYStart.unit === 'px' && translateYEnd.unit === 'px') {\n      return {\n        top: `${Math.abs(translateYEnd.value) * -1}px`,\n        bottom: `${Math.abs(translateYStart.value) * -1}px`,\n      };\n    }\n\n    if (translateYStart.unit === '%' && translateYEnd.unit === '%') {\n      const clientRect =\n        layer.targetElement?.getBoundingClientRect() ?? FALLBACK_RECT;\n      const top = Math.abs(clientRect.height * 0.01 * translateYEnd.value) * -1;\n      const bottom =\n        Math.abs(clientRect.height * 0.01 * translateYStart.value) * -1;\n      return {\n        top: `${top}px`,\n        bottom: `${bottom}px`,\n      };\n    }\n  }\n\n  if (layer.speed) {\n    const speed = layer.speed || 0;\n    const absSpeed = Math.abs(speed) * 10 * -1;\n\n    return {\n      top: `${absSpeed}px`,\n      bottom: `${absSpeed}px`,\n    };\n  }\n\n  return {};\n}\n","import { BannerLayer } from '../types';\n\nexport function getImageStyle(layer: BannerLayer) {\n  return layer.image\n    ? {\n        backgroundImage: `url(${layer.image})`,\n        backgroundPosition: 'center',\n        backgroundSize: 'cover',\n      }\n    : {};\n}\n","import React, { CSSProperties } from 'react';\nimport { useParallax } from '../../../hooks/useParallax';\nimport { getIsolatedParallaxProps } from '../../../helpers/getIsolatedParallaxProps';\nimport { getExpandedStyle } from '../helpers/getExpandedStyle';\nimport { getImageStyle } from '../helpers/getImageStyle';\nimport { BannerLayer } from '../types';\n\nconst absoluteStyle: CSSProperties = {\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n};\n\nexport const ParallaxBannerLayer = (\n  props: BannerLayer & { testId?: string }\n) => {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const {\n    children,\n    disabled,\n    style,\n    expanded = true,\n    image,\n    testId,\n    ...divProps\n  } = rest;\n\n  const imageStyle = getImageStyle(props);\n  const expandedStyle = expanded ? getExpandedStyle(props) : {};\n  const parallax = useParallax<HTMLDivElement>({\n    targetElement: props.targetElement,\n    shouldDisableScalingTranslations: true,\n    ...parallaxProps,\n  });\n\n  return (\n    <div\n      data-testid={testId}\n      ref={parallax.ref}\n      style={{\n        ...imageStyle,\n        ...absoluteStyle,\n        ...expandedStyle,\n        ...style,\n      }}\n      {...divProps}\n    >\n      {rest.children}\n    </div>\n  );\n};\n","import React, {\n  PropsWithChildren,\n  CSSProperties,\n  useEffect,\n  useRef,\n  useState,\n  ReactElement,\n} from 'react';\nimport { ParallaxBannerLayer } from './components/ParallaxBannerLayer';\nimport { ParallaxBannerProps } from './types';\n\nconst containerStyle: CSSProperties = {\n  position: 'relative',\n  overflow: 'hidden',\n  width: '100%',\n};\n\nexport const ParallaxBanner = (\n  props: PropsWithChildren<ParallaxBannerProps>\n) => {\n  const [targetElement, setTargetElement] =\n    useState<HTMLDivElement | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    setTargetElement(containerRef.current);\n  }, []);\n  const {\n    disabled: disableAllLayers,\n    style: rootStyle,\n    layers = [],\n    ...rootRest\n  } = props;\n\n  function renderLayers() {\n    if (targetElement) {\n      const shouldUseLayers = layers && layers.length > 0;\n      if (shouldUseLayers) {\n        return layers.map((layer, i) => (\n          <ParallaxBannerLayer\n            {...layer}\n            targetElement={targetElement}\n            key={`layer-${i}`}\n            testId={`layer-${i}`}\n          />\n        ));\n      }\n    }\n    return null;\n  }\n\n  function renderChildren() {\n    if (targetElement) {\n      return React.Children.map(props.children, (child) => {\n        const item = child as ReactElement<\n          PropsWithChildren<{ targetElement: any }>\n        >;\n        // adds the targetElement prop to any ParallaxBannerLayer components\n        if (item?.type === ParallaxBannerLayer) {\n          const clone = React.cloneElement(item, {\n            targetElement,\n          });\n          return clone;\n        }\n        return child;\n      });\n    }\n    return null;\n  }\n  return (\n    <div\n      ref={containerRef}\n      style={{ ...containerStyle, ...rootStyle }}\n      {...rootRest}\n    >\n      {/* Using the `layers` prop to define children */}\n      {renderLayers()}\n      {/* Using children to compose layers */}\n      {renderChildren()}\n    </div>\n  );\n};\n","import {\n  ParallaxController,\n  ParallaxControllerOptions,\n} from 'parallax-controller';\n\nexport const createController = (options: ParallaxControllerOptions) => {\n  // Don't initialize on the server\n  const isServer = typeof window === 'undefined';\n\n  if (!isServer) {\n    // Must not be the server so kick it off...\n    return ParallaxController.init(options);\n  }\n  return null;\n};\n","import React, { PropsWithChildren, useEffect, useRef } from 'react';\n\nimport { ParallaxContext } from '../../context/ParallaxContext';\nimport { ParallaxController, ScrollAxis } from 'parallax-controller';\nimport { ParallaxProviderProps } from './types';\nimport { createController } from './helpers';\n\nexport function ParallaxProvider(\n  props: PropsWithChildren<ParallaxProviderProps>\n) {\n  const controller = useRef<null | ParallaxController>(null);\n\n  if (!controller.current) {\n    controller.current = createController({\n      scrollAxis: props.scrollAxis || ScrollAxis.vertical,\n      scrollContainer: props.scrollContainer,\n      disabled: props.isDisabled,\n    });\n  }\n\n  // update scroll container\n  useEffect(() => {\n    if (props.scrollContainer && controller.current) {\n      controller.current.updateScrollContainer(props.scrollContainer);\n    }\n  }, [props.scrollContainer]);\n\n  // disable/enable parallax\n  useEffect(() => {\n    if (props.isDisabled && controller.current) {\n      controller.current.disableParallaxController();\n    }\n    if (!props.isDisabled && controller.current) {\n      controller.current.enableParallaxController();\n    }\n  }, [props.isDisabled]);\n\n  // remove the controller when unmounting\n  useEffect(() => {\n    return () => {\n      controller?.current?.destroy();\n    };\n  }, []);\n\n  return (\n    <ParallaxContext.Provider value={controller.current}>\n      {props.children}\n    </ParallaxContext.Provider>\n  );\n}\n"],"mappings":"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"}